\documentclass[12pt, letterpaper, titlepage]{article}
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}
\SetSymbolFont{letters}{normal}{OML}{txmi}{m}{it}
\DeclareSymbolFont{matha}{OML}{txmi}{m}{it}% txfonts
\DeclareMathSymbol{l}{\mathord}{matha}{21}
\usepackage[T1,T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{parskip}
\usepackage{svg}
\usepackage{array}
\usepackage{float}
\title{"Курсовая работа по дискретной математике"}
\author{Иван Кочкожаров, студент группы М8О-108Б-22}
\begin{document}
\maketitle
\textbf{1.} Определить для орграфа, заданного матрицей смежности $A$ =
$
    \begin{pmatrix}
        0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 1 \\
        1 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
$
\begin{itemize}
    \item[a)] матрицу односторонней связности;
    \item[б)] матрицу сильной связности;
    \item[в)] компоненты сильной связности;
    \item[г)] матрицу контуров.
\end{itemize}
\underline{\textbf{Решение.}}

\emph{Изображение графа:}
\begin{figure}[H]\centering\includesvg[scale=0.33]{graphs/graph1}\caption{Граф $G$}\end{figure}
\emph{Матрица односторнней связности:}
\begin{equation*}
    A = A(D) =
    \begin{tabular}{ | c | c | c | c | c | c | }
        \hline
                & $v_{1}$ & $v_{2}$ & $v_{3}$ & $v_{4}$ \\
        \hline
        $v_{1}$ & 0       & 1       & 0       & 1       \\
        \hline
        $v_{2}$ & 0       & 0       & 0       & 1       \\
        \hline
        $v_{3}$ & 1       & 1       & 0       & 1       \\
        \hline
        $v_{4}$ & 0       & 0       & 0       & 0       \\
        \hline
    \end{tabular}.
\end{equation*}
$
    A^{2} =
    \begin{pmatrix}
        0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 1 \\
        1 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
    \begin{pmatrix}
        0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 1 \\
        1 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =
    \begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}.
$\\
$
    A^{3} = A \cdot A^{2} =
    \begin{pmatrix}
        0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 1 \\
        1 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
    \begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =
    \begin{pmatrix}
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}.
$
\begin{equation*}
    \begin{split}
        T(D) = E \lor A \lor A^{2} \lor A^{3} =
        \begin{pmatrix}
            1 & 0 & 0 & 0 \\
            0 & 1 & 0 & 0 \\
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 1 \\
        \end{pmatrix}
        \lor
        \begin{pmatrix}
            0 & 1 & 0 & 1 \\
            0 & 0 & 0 & 1 \\
            1 & 1 & 0 & 1 \\
            0 & 0 & 0 & 0 \\
        \end{pmatrix}
        \lor &
        \begin{pmatrix}
            0 & 0 & 0 & 1 \\
            0 & 0 & 0 & 0 \\
            0 & 1 & 0 & 1 \\
            0 & 0 & 0 & 0 \\
        \end{pmatrix}
        \lor\\
        \lor
        \begin{pmatrix}
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 1 \\
            0 & 0 & 0 & 0 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
            1 & 1 & 0 & 1 \\
            0 & 1 & 0 & 1 \\
            1 & 1 & 1 & 1 \\
            0 & 0 & 0 & 1 \\
        \end{pmatrix}.
    \end{split}
\end{equation*}
\emph{Матрица двусторонней связности:}
\begin{equation*}
    S(D) = T(D) \& [T(D)]^\mathrm{T} =
    \begin{pmatrix}
        1 & 1 & 0 & 1 \\
        0 & 1 & 0 & 1 \\
        1 & 1 & 1 & 1 \\
        0 & 0 & 0 & 1 \\
    \end{pmatrix}
    \&
    \begin{pmatrix}
        1 & 0 & 1 & 0 \\
        1 & 1 & 1 & 0 \\
        0 & 0 & 1 & 0 \\
        1 & 1 & 1 & 1 \\
    \end{pmatrix}
    =
    \begin{pmatrix}
        1 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 \\
        0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 1 \\
    \end{pmatrix}.
\end{equation*}
$S(D)=E\Rightarrow$ в графе $D$ нет контуров.

\emph{Компонентны сильной связности:}
\begin{equation*}
    S_2(D) = S(D) =
    \begin{tabular}{ | c | c | c | c | c | c | }
        \hline
                & $v_{1}$ & $v_{2}$ & $v_{3}$ & $v_{4}$ \\
        \hline
        $v_{1}$ & 1       & 0       & 0       & 0       \\
        \hline
        $v_{2}$ & 0       & 1       & 0       & 0       \\
        \hline
        $v_{3}$ & 0       & 0       & 1       & 0       \\
        \hline
        $v_{4}$ & 0       & 0       & 0       & 1       \\
        \hline
    \end{tabular}
\end{equation*}
$D_1=(V_1,X_1), V_1=\{v_1\}$

$A(D_1)=$
\begin{tabular}{|c|c|}
    \hline
            & $v_{1}$ \\
    \hline
    $v_{1}$ & 0       \\
    \hline
\end{tabular}\hspace{1cm}$D_1:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc1}

\begin{equation*}
    S_2(D) =
    \begin{tabular}{ | c | c | c | c |  }
        \hline
                & $v_{2}$ & $v_{3}$ & $v_{4}$ \\
        \hline
        $v_{2}$ & 1       & 0       & 0       \\
        \hline
        $v_{3}$ & 0       & 1       & 0       \\
        \hline
        $v_{4}$ & 0       & 0       & 1       \\
        \hline
    \end{tabular}
\end{equation*}
$D_2=(V_2,X_2), V_2=\{v_2\}$

$A(D_2)=$
\begin{tabular}{|c|c|}
    \hline
            & $v_{2}$ \\
    \hline
    $v_{2}$ & 0       \\
    \hline
\end{tabular}\hspace{1cm}$D_2:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc2}

\begin{equation*}
    S_3(D) =
    \begin{tabular}{ | c | c | c |  }
        \hline
                & $v_{3}$ & $v_{4}$ \\
        \hline
        $v_{3}$ & 1       & 0       \\
        \hline
        $v_{4}$ & 0       & 1       \\
        \hline
    \end{tabular}
\end{equation*}
$D_3=(V_3,X_3), V_3=\{v_3\}$

$A(D_3)=$
\begin{tabular}{|c|c|}
    \hline
            & $v_{3}$ \\
    \hline
    $v_{3}$ & 0       \\
    \hline
\end{tabular}\hspace{1cm}$D_3:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc3}

\begin{equation*}
    S_4(D) =
    \begin{tabular}{ | c | c | }
        \hline
                & $v_{4}$ \\
        \hline
        $v_{4}$ & 1       \\
        \hline
    \end{tabular}
\end{equation*}
$D_4=(V_4,X_4), V_4=\{v_4\}$

$A(D_4)=$
\begin{tabular}{|c|c|}
    \hline
            & $v_{4}$ \\
    \hline
    $v_{4}$ & 0       \\
    \hline
\end{tabular}\hspace{1cm}$D_4:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc4}

\emph{Матрица контуров:}
\begin{equation*}
    K(D)=A(D) \& S(D) =
    \begin{pmatrix}
        0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 1 \\
        1 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
    \begin{pmatrix}
        1 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 \\
        0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 1 \\
    \end{pmatrix}
    =
    \begin{pmatrix}
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
\end{equation*}

\textbf{2.} Используя алгоритм Терри, определить замкнутый маршрут, проходящий ровно по два раза
(по одному в каждом направлении) через каждое ребро графа.
\begin{figure}[H]\centering\includesvg[scale=0.65]{graphs/init_terry}\caption{Граф $G$}\end{figure}
\underline{\textbf{Решение.}}

Для решения этой задачи действуем в соответствии с алгоритмом Тэрри.
Для реализации алгоритма помечаем первые заходящие в вершины ребра крестиками, которые наносим на
ребрах ближе к той вершине в которую в первый
раз заходим, а также указываем направления прохождения ребер и последовательность
прохождения ребер. Алгоритм дает следующий возможный маршрут:
\begin{equation*}
    v_1v_2v_3v_5v_4v_3v_4v_2v_4v_1v_4v_5v_3v_2v_1
\end{equation*}
\begin{figure}[H]\centering\includesvg[scale=1]{graphs/terry}\caption{Визуализация алгоритма Терри}\end{figure}
\iffalse
    \textbf{3.} Используя алгоритм “фронта волны”, найти все минимальные пути из первой вершины в
    последнюю орграфа, заданного матрицей смежности
    \begin{equation*}
        A =
        \begin{pmatrix}
            0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 \\
            1 & 0 & 1 & 1 & 1 & 1 & 0 & 0 \\
            1 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
            1 & 1 & 1 & 0 & 0 & 1 & 0 & 0 \\
            1 & 1 & 1 & 1 & 0 & 0 & 1 & 1 \\
            0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 \\
            1 & 0 & 1 & 1 & 1 & 1 & 1 & 0 \\
            1 & 0 & 1 & 1 & 0 & 0 & 1 & 0 \\
        \end{pmatrix}.
    \end{equation*}
\fi
\textbf{3.} Орграф $D=(V,X)$, где $V = \{v_1, \dots, v_{10}\}$ задан матрицей
смежности $A(D)$. Найти все минимальные пути $v_1$ в $v_{8}$.
\begin{equation*}
    A = A(D) =
    \begin{tabular}{ | c | c | c | c | c | c | c | c | c |}
        \hline
              & $v_1$ & $v_2$ & $v_3$ & $v_4$ & $v_5$ & $v_6$ & $v_7$ & $v_8$ \\
        \hline
        $v_1$ & 0     & 0     & 1     & 0     & 0     & 1     & 0     & 0     \\
        \hline
        $v_2$ & 1     & 0     & 1     & 1     & 1     & 1     & 0     & 0     \\
        \hline
        $v_3$ & 1     & 0     & 0     & 0     & 0     & 1     & 0     & 0     \\
        \hline
        $v_4$ & 1     & 1     & 1     & 0     & 0     & 1     & 0     & 0     \\
        \hline
        $v_5$ & 1     & 1     & 1     & 1     & 0     & 0     & 1     & 1     \\
        \hline
        $v_6$ & 0     & 0     & 1     & 1     & 0     & 0     & 0     & 0     \\
        \hline
        $v_7$ & 1     & 0     & 1     & 1     & 1     & 1     & 1     & 0     \\
        \hline
        $v_8$ & 1     & 0     & 1     & 1     & 0     & 0     & 1     & 0     \\
        \hline
    \end{tabular}.
\end{equation*}
\underline{\textbf{Решение.}}

Действуя согласно алгоритму фронта волны, последовательно определяем:

$FW_0(v_1)=\{v_1\}, FW_1(v_1)=D(v_1)=\{v_3,v_6\},$\\
$FW_2(v_1)=D(FW_1(v_1)) \setminus (FW_0(v_1) \cup FW_1(v_1))=D(\{v_3,v_6\}) \setminus \{v_1,v_3,v_6\}=$\\
$=\{v_1,v_3,v_4,v_6\} \setminus \{v_1,v_3,v_6\}=\{v_4\}$\\
$FW_3(v_1)=D(FW_2(v_1)) \setminus (FW_0(v_1)\cup FW_1(v_1)\cup FW_2(v_1))=\{v_1,v_2,v_3,v_6\} \setminus$\\
$\setminus \{v_1,v_3,v_4,v_6\}=\{v_2\}$\\
$FW_4(v_1)=D(FW_3(v_1)) \setminus (FW_0(v_1)\cup FW_1(v_1)\cup FW_2(v_1)\cup FW_3(v_1))=$\\
$=\{v_1,v_3,v_4,v_5,v_6\} \setminus \{v_1,v_2,v_3,v_4,v_6\}=\{v_5\}$\\
$FW_5(v_1)=D(FW_4(v_1)) \setminus (FW_0(v_1)\cup FW_1(v_1)\cup FW_2(v_1)\cup FW_3(v_1)\cup FW_4(v_1))=$\\
$\{v_1,v_2,v_3,v_4,v_7,v_8\}\setminus \{v_1,v_2,v_3,v_4,v_5,v_6\}=\{v_7,v_8\}$

Таким образом, $v_8 \in FW_5(v_1)$, а следовательно, согласно алгоритму фронта волны существует минимальный
путь в орграфе $D$ из $v_1$ в $v_8$ длины 5. Найдём все эти пути.
\begin{figure}[H]\centering\includesvg[scale=0.45]{graphs/fw1}\caption{Граф D'}\end{figure}
На рисунке 4 изображен подграф $D'$ орграфа $D$, на котором последовательно изображены множества
$FW_k(v_1), k=1,2,3,4,5$, а так же  дуги вида $(v, v')$, где для некоторого $k \in \{0,1,2,3,4\},
    v \in FW_k(v_1), v' \in FW_{k+1}(v_1)$, т.е. исходящие из вершин некоторого $k$-го фронта волны и
заходящие в вершины следующего $(k+1)$-го фронта волны.

Используя изображение $D'$ нетрудно выделить все минимальные пути из $v_1$ в $v_8$
в орграфе $D$. При этом, следуя алгоритму фронта волны, находим эти минимальные пути, используя орграф $D'$
но двигаясь в $D'$ в обратной последовательности (т.е. не из $v1$ в $v_8$ а наоборот, из $v_8$
в $v_1$ ). Используя рисунок 4, получаем, что в любом минимальном пути из $v_1$ в $v_8$
соблюдается следующая последовательность вершин. Вершиной, предшествующей
вершине $v_8$ может быть $v_5$. Вершиной, предшествующей вершине $5$
может быть $v_2$. Вершиной, предшествующей вершине $v_2$ – вершина $v_4$.
Вершиной, предшествующей вершине $v_4$ – любая из вершин $v_3,v_6$.
Вершиной, предшествующей вершинам $v_3$ и $v_6$ может быть только $v_1$. Этими условиями однозначно определяется множество
минимальных путей из $v_1$ в $v_8$ которое компактно изображено на рисунке 5. На этом
рисунке изображены все вершины, входящие в минимальные пути $v_1$ в $v_8$ Для каждой
из промежуточных вершин $v$ показано множество вершин, которые могут ей
предшествовать, а также соответствующие дуги (исходящие из вершин, предшествующих $v$
и заходящие в $v$). Из рисунка 5 видно, что всего существует два минимальных пути из $v_1$ в
$v_8$: $v_1v_3v_4v_2v_5v_8$, $v_1v_6v_4v_2v_5v_8$.
\begin{figure}[H]\centering\includesvg[scale=0.5]{graphs/fw2}\caption{Граф минимальных путей}\end{figure}
\newpage
\textbf{4.} Нагруженный орграф $D$ задан матрицей длин дуг $C(D)$. Найти минимальные пути из $v_1$ во все достижимые вершины.
\[
    C(D)=
    \begin{pmatrix}
        \infty & 4      & \infty & \infty & 5      & \infty & \infty & \infty \\
        5      & \infty & 7      & 10     & 2      & \infty & \infty & \infty \\
        \infty & \infty & \infty & 2      & \infty & 2      & \infty & \infty \\
        6      & \infty & \infty & \infty & \infty & \infty & 3      & 5      \\
        3      & 2      & \infty & \infty & \infty & 3      & 11     & \infty \\
        4      & \infty & 2      & \infty & \infty & \infty & 7      & \infty \\
        8      & \infty & \infty & 3      & \infty & \infty & \infty & 3      \\
        \infty & \infty & \infty & \infty & 17     & \infty & \infty & \infty \\
    \end{pmatrix}
\]

\underline{\textbf{Решение.}}

Воспользуемся алгоритмом Форда. Сначала определим таблицу величин $l_{i}^{(i)}, i=1,2,\dots,n-1$, где $n=8$
\begin{center}
    \begin{tabular}{ | c | c | c | c | c | c | c | c | c | c |c |c |c |c |c |c |c |c |}
        \hline
        \rule{0pt}{13pt} & $v_1$      & $v_2$      & $v_3$      & $v_4$       & $v_5$       & $v_6$       & $v_7$     & $v_8$     &
                         & $l^{(0)}$  & $l^{(1)}$  & $l^{(2)}$  & $l^{(3)}$   & $l^{(4)}$   & $l^{(5)}$   & $l^{(6)}$ & $l^{(7)}$   \\
        \hline
        $v_1$            & $\infty$   & 4          & $\infty$   & $\infty$    & 5           & $\infty$    & $\infty$  & $\infty$  &
                         & \textbf{0} & 0          & 0          & 0           & 0           & 0           & 0         & 0           \\
        \hline
        $v_2$            & 5          & $\infty$   & 7          & 10          & 2           & $\infty$    & $\infty$  & $\infty$  &
                         & $\infty$   & 4          & 4          & 4           & 4           & 4           & 4         & 4           \\
        \hline
        $v_3$            & $\infty$   & $\infty$   & $\infty$   & 2           & $\infty$    & 2           & $\infty$  & $\infty$  &
                         & $\infty$   & $\infty$   & 11         & \textbf{10} & 10          & 10          & 10        & 10          \\
        \hline
        $v_4$            & 6          & $\infty$   & $\infty$   & $\infty$    & $\infty$    & $\infty$    & 3         & 5         &
                         & $\infty$   & $\infty$   & 14         & 13          & \textbf{12} & 12          & 12        & 12          \\
        \hline
        $v_5$            & 3          & 2          & $\infty$   & $\infty$    & $\infty$    & 3           & 11        & $\infty$  &
                         & $\infty$   & \textbf{5} & 5          & 5           & 5           & 5           & 5         & 5           \\
        \hline
        $v_6$            & 4          & $\infty$   & 2          & $\infty$    & $\infty$    & $\infty$    & 7         & $\infty$  &
                         & $\infty$   & $\infty$   & \textbf{8} & 8           & 8           & 8           & 8         & 8           \\
        \hline
        $v_7$            & 8          & $\infty$   & $\infty$   & 3           & $\infty$    & $\infty$    & $\infty$  & 3         &
                         & $\infty$   & $\infty$   & 16         & 15          & 15          & 15          & 15        & 15          \\
        \hline
        $v_8$            & $\infty$   & $\infty$   & $\infty$   & $\infty$    & 17          & $\infty$    & $\infty$  & $\infty$  &
                         & $\infty$   & $\infty$   & $\infty$   & 19          & 18          & \textbf{17} & 17        & 17          \\
        \hline
    \end{tabular}
\end{center}
\hspace{3.5cm}$C(D)$\hspace{6.5cm}Таблица величин

Обозначим $l^{(k)}=(l_1^{(k)},\dots,l_8^{(k)})^\mathrm{T}$, где $k=0,1,\dots,7$. Это столбцы в
таблице величин. Первая строка по таблицы величин состоит из нулевых элементов ($l^{(k)}_1=0,k=0,1,\dots,7$),
а первый столбец заполняем следующим образом: $l_i^{(0)}=\infty,i=2,\dots,8$. Далее, используя формулу
$l_j^{(k+1)}=\displaystyle\min_{1\le i\le8}\{l_i^{(k)}+c_{ij}\}$ последовательно определяем элементы столбца
$l^{(1)}$, используя элементы столбца $l^{(0)}$ (а так же элементы матрицы $C(D)$), затем находим элементы
столбца $l^{(2)}$, используя элементы столбца $l^{(1)}$ и т.д.

Длина минимального пути из $v_1$ в $v_8$ равна 17. Вершине $v_8$ предшествует $v_4$, потому что $l^{(5)}_8=17=l^{(4)}_4+c_{48}=12+5$.
Вершине $v_4$ предшествует $v_3$ и т.д. В итоге получаем минимальный путь: $v_1v_5v_6v_3v_4v_8$ (в таблице выделен жирным шрифтом). Соответственно,
$v_1v_5v_6v_3v_4$, $v_1v_5v_6v_3$, $v_1v_5v_6$, $v_1v_5$ - минимальные пути из $v_1$ в соответствующие вершины.
Минимальный путь из $v_1$ в $v_7$ находится аналогично. Получаем такой минимальный путь: $v_1v_5v_6v_7$.
Минимальный путь из $v_1$ в $v_2$, очевидно, $v_1v_2$.
\newpage
\textbf{5.}  Найти остовное дерево графа $G$ с минимальной суммой длин входящих в него ребер.
\begin{figure}[H]\centering\includesvg[scale=0.5]{graphs/kruskal}\caption{Граф $G$}\end{figure}
\underline{\textbf{Решение.}}
Согласно алгоритму Краскала выбираем ребро $\{v_5,v_6\}$ минимальной длины 1.
Выделяем его жирной линией (cм. рис. 7). Далее выбираем ребро минимальной длины,
соединяющее либо $v_5$ либо $v_6$ с какой-нибудь новой (т.е. отличной от $v_1,v_5$) вершиной
графа $G$ (т.е. выбираем среди ребер $\{v_5,v_1\}$,$\{v_5,v_9\}$,$\{v_6,v_2\}$,
$\{v_6,v_7\}$,$\{v_6,v_{10}\}$). Минимальную длину имеет ребро \{$v_5,v_9$\}. Выделяем его жирной линией (см. рис. 7).
Далее выбираем ребро минимальной длины, соединяющее либо $v_5$, либо $v_6$, либо $v_9$ с какой-нибудь новой
вершиной графа (выбираем между $\{v_9,v_{10}\}$,$\{v_6,v_{10}\}$,$\{v_6,v_7\}$,$\{v_6,v_2\}$,$\{v_5,v_1\}$).
Минимальную длину имеет ребро $\{v_5,v_1\}$ Выделяем его жирной линией (см. рис. 7).
Следующим ребром минимальной длины (если таких несколько, можно выбрать любое) среди всех возможных является $\{v_{1},v_{2}\}$, затем $\{v_{2},v_{3}\}$,
далее $\{v_{3},v_{4}\}$, далее $\{v_4,v_8\}$, далее $\{v_8,v_{12}\}$, далее $\{v_7,v_8\}$, далее $\{v_7,v_{11}\}$ и, наконец, $\{v_6,v_{10}\}$.
Выделено $11 = 12-1 = n(G)-1$ ребер, алгоритм окончен, выделяем минимальное остовное дерево графа (см. на рис. 7 подграф графа $G$, ребра которого выделены жирными линиями).
\begin{figure}[H]\centering\includesvg[scale=0.5]{graphs/kruskal_res}\caption{Граф $G$ с выделенным подграфом - минимальным остовным деревом}\end{figure}
\textbf{5.} Пусть каждому ребру неориентированного графа
изображенного на рис. 8 соответствует некоторый элемент электрической цепи.
Составить линейно независимые системы уравнений Кирхгофа для токов и напряжений.
Пусть первому и пятому ребру соответствуют источники тока с ЭДС $E_1$ и $E_2$ (полярность
выбирается произвольно), а остальные элементы являются сопротивлениями. Используя
закон Ома, и, предполагая внутренние сопротивления источников тока равными нулю,
получить общую систему уравнений для токов.
\begin{figure}[H]\centering\includesvg[scale=0.8]{graphs/kirchhoff.svg}\caption{Граф $G$}\end{figure}
\underline{\textbf{Решение.}}
Выделим произвольным образом остовное дерево графа. Для графа изображенного на рис. 8, одним из возможных
остовных деревьев является дерево, изображенное на рис. 9 (пунктирными линиями
изображены удаленные из ребра).
\begin{figure}[H]\centering\includesvg[scale=0.8]{graphs/ostov_kirchhoff.svg}\caption{Остовное дерево графа $G$}\end{figure}
Добавляя любое из ребер, не вошедших в остовное дерево графа $G$ (изображенных
на рис. 9 пунктирными линиями), мы получим граф с некоторым простым циклом. Всего в остовное дерево не вошли
$v(G)=m(G)-n(G)+1$ ребер (для графа, изображенного на рис. 8, $v(G)=10-6+1=5$ ), а поэтому можем
получить таким образом $v(G)=5$ простых циклов. Эти циклы различны в том смысле что
каждый из них проходит через ребро (то самое, которое мы добавляли для выделения
данного цикла), через которое не проходит ни один другой цикл. Они образуют \emph{цикловой
базис графа} $G$.

Для графа, изображенного на рис. 8 в цикловой базис войдут циклы:\\
$\mu_1 = \mu_1(x_1)=x_1x_6x_9x_{10}, \mu_2 = \mu_2(x_2)=x_2x_3x_4,\mu_3=\mu_3(x_5)=x_5x_6x_4$\\
$\mu_4 = \mu_4(x_7)=x_7x_9x_6x_4, \mu_5=\mu_5(x_8)=x_8x_6x_9$

Введем произвольную ориентацию на ребрах графа $G$. В результате каждое ребро $x_j$ превратится
в дугу $\tilde{x_j}$ и, соответственно, множество ребер $X$ в множество дуг $\widetilde{X}$,
а сам граф $G=(V,X)$ в орграф $D=(V,\widetilde{X})$. Для графа $G$, изображенного на рис. 8,
в результате введения ориентации на его ребрах получаем, например, оргаф $D=(V, \widetilde{X})$,
изображенный на рис. 10.
\begin{figure}[H]\centering\includesvg[scale=0.8]{graphs/oriented_kirchhoff.svg}\caption{Орграф $D$}\end{figure}
Для графа $G$ с выделенным ранее цикловым базисом $\mu1,\mu2,\mu3,\mu4,\mu5$ и выбранной ориентацией ребер,
соответствующей орграфу $D$, изображенному на рис. 10, цикломатическая матрица имеет вид:
\[
C(G)=
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    &*&*&&&*&&*&*&&\\
    \hline
    & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $x_8$ & $x_9$ & $x_{10}$\\
    \hline
    $\mu_1$ & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & -1 & -1 \\
    \hline
    $\mu_2$ & 0 & 1 & -1 & -1 & 0 & 0 & 0 & 0& 0& 0\\
    \hline
    $\mu_3$ & 0 & 0 & 0 & 1 & -1 & -1 & 0& 0& 0& 0 \\
    \hline
    $\mu_4$ & 0 & 0 & 0 & 1 & 0 & -1 & -1&0& 1& 0 \\
    \hline
    $\mu_5$ & 0 & 0 & 0 & 0 & 0 & 1 & 0 &1& -1& 0 \\
    \hline
\end{tabular}
\]
При построении циклового базиса графа $G$ мы поочередно добавляли к остовному дереву
графа $G$ ребра $x_1,x_2,x_5,x_7,x_8$. Выделяем соответствующие этим ребрам столбцы
в матрице $C(G)$. Из выделенных столбцов составим матрицу и найдем ее определитель.
\[
    \begin{vmatrix}
    1&0&0&0&0\\
    0&1&0&0&0\\
    0&0&-1&0&0\\
    0&0&0&-1&0\\
    0&0&0&0&0\\
    \end{vmatrix}
    \neq0
\]
Ранг матрицы $C(G)$ равен числу строк, т.е. $v(G)$.

Пусть теперь граф $G$ соответсвует электрической цепи, где первому и пятому ребру соответствуют
$E_1$ и $E_2$ (полярность выбирается произвольно), а остальные элементы являются сопротивлениями.

Выберем произвольным образом направления токов в элементах цепи (условные
направления; после решения соответствующей системы уравнений знаки при величинах
токов покажут истинные направления токов). Пусть эти направления соответствуют
выбранной ранее ориентации ребер графа $G$. Ввпишем систему уравнений Кирхгофа для напряжений:\\
$
\mu_1: -u_1+u_6-u_9-u_{10}=0\\
\mu_2: u_2-u_3-u_4=0\\
\mu_3: u_4-u_5-u_6=0\\
\mu_4: u_4-u_6-u_7+u_9=0\\
\mu_5: u_6+u_8-u_9=0\\
$
или, с учетом закона Ома, а также того, что $u_1=E_1, u_5=E_2$, имеем:
\[
    \begin{cases}
        -E_1\\
        d
    \end{cases}
\]
\end{document}
