\documentclass[12pt, letterpaper, titlepage]{article}
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}
\DeclareSymbolFont{matha}{OML}{txmi}{m}{it}% txfonts
\DeclareMathSymbol{v}{\mathord}{matha}{118}
\DeclareMathSymbol{l}{\mathord}{matha}{21}
\usepackage[T1,T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{parskip}
\usepackage{svg}
\usepackage{array}
\usepackage{float}
\title{"Курсовая работа по дискретной математике"}
\author{Иван Кочкожаров, студент группы М8О-108Б-22}
\begin{document}
\maketitle
\textbf{1.} Определить для орграфа, заданного матрицей смежности $A$ = 
$
\begin{pmatrix}
    0 & 1 & 0 & 1\\
    0 & 0 & 0 & 1\\
    1 & 1 & 0 & 1\\
    0 & 0 & 0 & 0\\
\end{pmatrix}
$
\begin{itemize}
    \item[a)] матрицу односторонней связности;
    \item[б)] матрицу сильной связности;
    \item[в)] компоненты сильной связности;
    \item[г)] матрицу контуров.
\end{itemize}
\underline{\textbf{Решение.}}

\emph{Изображение графа:}
\begin{center}
    \includesvg[scale=0.5]{graphs/graph1}
\end{center}
\emph{Матрица односторнней связности:}
\begin{equation*}
A = A(D) = 
\begin{tabular}{ | c | c | c | c | c | c | } 
    \hline
    & $v_{1}$ & $v_{2}$ & $v_{3}$ & $v_{4}$\\ 
    \hline
    $v_{1}$ & 0 & 1 & 0 & 1\\ 
    \hline
    $v_{2}$ & 0 & 0 & 0 & 1\\ 
    \hline
    $v_{3}$ & 1 & 1 & 0 & 1\\
    \hline
    $v_{4}$ & 0 & 0 & 0 & 0\\
    \hline
\end{tabular}.
\end{equation*}
$
A^{2} = 
\begin{pmatrix}
    0 & 1 & 0 & 1\\
    0 & 0 & 0 & 1\\
    1 & 1 & 0 & 1\\
    0 & 0 & 0 & 0\\
\end{pmatrix}
\begin{pmatrix}
    0 & 1 & 0 & 1\\
    0 & 0 & 0 & 1\\
    1 & 1 & 0 & 1\\
    0 & 0 & 0 & 0\\
\end{pmatrix}
=
\begin{pmatrix}
    0 & 0 & 0 & 1\\
    0 & 0 & 0 & 0\\
    0 & 1 & 0 & 1\\
    0 & 0 & 0 & 0\\
\end{pmatrix}.
$\\
$
A^{3} = A \cdot A^{2} =
\begin{pmatrix}
    0 & 1 & 0 & 1\\
    0 & 0 & 0 & 1\\
    1 & 1 & 0 & 1\\
    0 & 0 & 0 & 0\\
\end{pmatrix}
\begin{pmatrix}
    0 & 0 & 0 & 1\\
    0 & 0 & 0 & 0\\
    0 & 1 & 0 & 1\\
    0 & 0 & 0 & 0\\
\end{pmatrix}
=
\begin{pmatrix}
    0 & 0 & 0 & 0\\
    0 & 0 & 0 & 0\\
    0 & 0 & 0 & 1\\
    0 & 0 & 0 & 0\\
\end{pmatrix}.
$
\begin{equation*}
    \begin{split}
    T(D) = E \lor A \lor A^{2} \lor A^{3} =
    \begin{pmatrix}
        1 & 0 & 0 & 0\\
        0 & 1 & 0 & 0\\
        0 & 0 & 1 & 0\\
        0 & 0 & 0 & 1\\
    \end{pmatrix}
    \lor 
    \begin{pmatrix}
        0 & 1 & 0 & 1\\
        0 & 0 & 0 & 1\\
        1 & 1 & 0 & 1\\
        0 & 0 & 0 & 0\\
    \end{pmatrix}
    \lor &
    \begin{pmatrix}
        0 & 0 & 0 & 1\\
        0 & 0 & 0 & 0\\
        0 & 1 & 0 & 1\\
        0 & 0 & 0 & 0\\
    \end{pmatrix}
    \lor\\
    \lor
    \begin{pmatrix}
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 1\\
        0 & 0 & 0 & 0\\
    \end{pmatrix}
    =
    \begin{pmatrix}
        1 & 1 & 0 & 1\\
        0 & 1 & 0 & 1\\
        1 & 1 & 1 & 1\\
        0 & 0 & 0 & 1\\
    \end{pmatrix}.
    \end{split}
\end{equation*}
\emph{Матрица двусторонней связности:}
\begin{equation*}
S(D) = T(D) \& [T(D)]^\mathrm{T} =     
\begin{pmatrix}
    1 & 1 & 0 & 1\\
    0 & 1 & 0 & 1\\
    1 & 1 & 1 & 1\\
    0 & 0 & 0 & 1\\
\end{pmatrix}
\&
\begin{pmatrix}
    1 & 0 & 1 & 0\\
    1 & 1 & 1 & 0\\
    0 & 0 & 1 & 0\\
    1 & 1 & 1 & 1\\
\end{pmatrix}
=
\begin{pmatrix}
    1 & 0 & 0 & 0\\
    0 & 1 & 0 & 0\\
    0 & 0 & 1 & 0\\
    0 & 0 & 0 & 1\\
\end{pmatrix}.
\end{equation*}
$S(D)=E\Rightarrow$ в графе $D$ нет контуров.

\emph{Компонентны сильной связности:}
\begin{equation*}
S_2(D) = S(D) = 
\begin{tabular}{ | c | c | c | c | c | c | } 
    \hline
    & $v_{1}$ & $v_{2}$ & $v_{3}$ & $v_{4}$\\ 
    \hline
    $v_{1}$ & 1 & 0 & 0 & 0\\ 
    \hline
    $v_{2}$ & 0 & 1 & 0 & 0\\ 
    \hline
    $v_{3}$ & 0 & 0 & 1 & 0\\
    \hline
    $v_{4}$ & 0 & 0 & 0 & 1\\
    \hline
\end{tabular}
\end{equation*}
$D_1=(V_1,X_1), V_1=\{v_1\}$

$A(D_1)=$
\begin{tabular}{|c|c|}
    \hline
    & $v_{1}$ \\ 
    \hline
    $v_{1}$ & 0 \\ 
    \hline
\end{tabular}\hspace{1cm}$D_1:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc1}

\begin{equation*}
    S_2(D) = 
    \begin{tabular}{ | c | c | c | c |  } 
        \hline
        & $v_{2}$ & $v_{3}$ & $v_{4}$ \\ 
        \hline
        $v_{2}$ & 1 & 0 & 0\\ 
        \hline
        $v_{3}$ & 0 & 1 & 0\\
        \hline
        $v_{4}$ & 0 & 0 & 1\\
        \hline
    \end{tabular}
\end{equation*}
$D_2=(V_2,X_2), V_2=\{v_2\}$

$A(D_2)=$
\begin{tabular}{|c|c|}
    \hline
    & $v_{2}$ \\ 
    \hline
    $v_{2}$ & 0 \\ 
    \hline
\end{tabular}\hspace{1cm}$D_2:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc2}

\begin{equation*}
    S_3(D) = 
    \begin{tabular}{ | c | c | c |  } 
        \hline
        & $v_{3}$ & $v_{4}$ \\ 
        \hline
        $v_{3}$  & 1 & 0\\ 
        \hline
        $v_{4}$  & 0 & 1\\
        \hline
    \end{tabular}
\end{equation*}
$D_3=(V_3,X_3), V_3=\{v_3\}$

$A(D_3)=$
\begin{tabular}{|c|c|}
    \hline
    & $v_{3}$ \\ 
    \hline
    $v_{3}$ & 0 \\ 
    \hline
\end{tabular}\hspace{1cm}$D_3:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc3}

\begin{equation*}
    S_4(D) = 
    \begin{tabular}{ | c | c | } 
        \hline
        & $v_{4}$ \\ 
        \hline
        $v_{4}$ & 1\\ 
        \hline
    \end{tabular}
\end{equation*}
$D_4=(V_4,X_4), V_4=\{v_4\}$

$A(D_4)=$
\begin{tabular}{|c|c|}
    \hline
    & $v_{4}$ \\ 
    \hline
    $v_{4}$ & 0 \\ 
    \hline
\end{tabular}\hspace{1cm}$D_4:$\hspace{1cm}
\includesvg[scale=0.09]{graphs/cfc4}

\emph{Матрица контуров:}
\begin{equation*}
    K(D)=A(D) \& S(D) = 
    \begin{pmatrix}
        0 & 1 & 0 & 1\\
        0 & 0 & 0 & 1\\
        1 & 1 & 0 & 1\\
        0 & 0 & 0 & 0\\
    \end{pmatrix}
    \begin{pmatrix}
        1 & 0 & 0 & 0\\
        0 & 1 & 0 & 0\\
        0 & 0 & 1 & 0\\
        0 & 0 & 0 & 1\\
    \end{pmatrix}
    =
    \begin{pmatrix}
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 0\\
    \end{pmatrix}
\end{equation*}

\textbf{2.} Используя алгоритм Терри, определить замкнутый маршрут, проходящий ровно по два раза
(по одному в каждом направлении) через каждое ребро графа.
\begin{center}\includesvg[scale=0.65]{graphs/init_terry}\end{center}
\underline{\textbf{Решение.}}

Для решения этой задачи действуем в соответствии с алгоритмом Тэрри.
Для реализации алгоритма помечаем первые заходящие в вершины ребра крестиками, которые наносим на 
ребрах ближе к той вершине в которую в первый
раз заходим, а также указываем направления прохождения ребер и последовательность
прохождения ребер. Алгоритм дает следующий возможный маршрут:
\begin{equation*}
    v_1v_2v_3v_5v_4v_3v_4v_2v_4v_1v_4v_5v_3v_2v_1
\end{equation*}
\begin{center}\includesvg{graphs/terry}\end{center}
\iffalse
\textbf{3.} Используя алгоритм “фронта волны”, найти все минимальные пути из первой вершины в
последнюю орграфа, заданного матрицей смежности
\begin{equation*}
    A =
    \begin{pmatrix}
        0 & 0 & 1 & 0 & 0 & 1 & 0 & 0\\
        1 & 0 & 1 & 1 & 1 & 1 & 0 & 0\\
        1 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
        1 & 1 & 1 & 0 & 0 & 1 & 0 & 0\\
        1 & 1 & 1 & 1 & 0 & 0 & 1 & 1\\
        0 & 0 & 1 & 1 & 0 & 0 & 0 & 0\\
        1 & 0 & 1 & 1 & 1 & 1 & 1 & 0\\
        1 & 0 & 1 & 1 & 0 & 0 & 1 & 0\\        
    \end{pmatrix}.
\end{equation*}
\fi
\textbf{3.} Орграф $D=(V,X)$, где $V = \{v_1, \dots, v_{10}\}$ задан матрицей
смежности $A(D)$. Найти все минимальные пути $v_1$ в $v_{8}$.
\begin{equation*}
    A = A(D) =
    \begin{tabular}{ | c | c | c | c | c | c | c | c | c |}
        \hline
        & $v_1$ & $v_2$ & $v_3$ & $v_4$ & $v_5$ & $v_6$ & $v_7$ & $v_8$\\
        \hline
        $v_1$& 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0\\
        \hline
        $v_2$& 1 & 0 & 1 & 1 & 1 & 1 & 0 & 0\\
        \hline
        $v_3$& 1 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
        \hline
        $v_4$& 1 & 1 & 1 & 0 & 0 & 1 & 0 & 0\\
        \hline
        $v_5$& 1 & 1 & 1 & 1 & 0 & 0 & 1 & 1\\
        \hline
        $v_6$& 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0\\
        \hline
        $v_7$& 1 & 0 & 1 & 1 & 1 & 1 & 1 & 0\\
        \hline
        $v_8$& 1 & 0 & 1 & 1 & 0 & 0 & 1 & 0\\
        \hline
    \end{tabular}.
\end{equation*}
\underline{\textbf{Решение.}}

Действуя согласно алгоритму фронта волны, последовательно определяем:

$FW_0(v_1)=\{v_1\}, FW_1(v_1)=D(v_1)=\{v_3,v_6\},$\\
$FW_2(v_1)=D(FW_1(v_1)) \setminus (FW_0(v_1) \cup FW_1(v_1))=D(\{v_3,v_6\}) \setminus \{v_1,v_3,v_6\}=$\\
$=\{v_1,v_3,v_4,v_6\} \setminus \{v_1,v_3,v_6\}=\{v_4\}$\\
$FW_3(v_1)=D(FW_2(v_1)) \setminus (FW_0(v_1)\cup FW_1(v_1)\cup FW_2(v_1))=\{v_1,v_2,v_3,v_6\} \setminus$\\
$\setminus \{v_1,v_3,v_4,v_6\}=\{v_2\}$\\
$FW_4(v_1)=D(FW_3(v_1)) \setminus (FW_0(v_1)\cup FW_1(v_1)\cup FW_2(v_1)\cup FW_3(v_1))=$\\
$=\{v_1,v_3,v_4,v_5,v_6\} \setminus \{v_1,v_2,v_3,v_4,v_6\}=\{v_5\}$\\
$FW_5(v_1)=D(FW_4(v_1)) \setminus (FW_0(v_1)\cup FW_1(v_1)\cup FW_2(v_1)\cup FW_3(v_1)\cup FW_4(v_1))=$\\
$\{v_1,v_2,v_3,v_4,v_7,v_8\}\setminus \{v_1,v_2,v_3,v_4,v_5,v_6\}=\{v_7,v_8\}$

Таким образом, $v_8 \in FW_5(v_1)$, а следовательно, согласно алгоритму фронта волны существует минимальный
путь в орграфе $D$ из $v_1$ в $v_8$ длины 5. Найдём все эти пути.
\begin{figure}[H]\centering\includesvg[scale=0.45]{graphs/fw1}\caption{График D'}\end{figure}
На рисунке изображен подграф $D'$ орграфа $D$, на котором последовательно изображены множества
$FW_k(v_1), k=1,2,3,4,5$, а так же  дуги вида $(v, v')$, где для некоторого $k \in \{0,1,2,3,4\},
v \in FW_k(v_1), v' \in FW_{k+1}(v_1)$, т.е. исходящие из вершин некоторого $k$-го фронта волны и
заходящие в вершины следующего $(k+1)$-го фронта волны.

Используя изображение $D'$ нетрудно выделить все минимальные пути из $v_1$ в $v_8$
в орграфе$D$. При этом, следуя алгоритму фронта волны, находим эти минимальные пути, используя орграф $D'$
но двигаясь в $D'$ в обратной последовательности (т.е. не из $v1$ в $v_8$ а наоборот, из $v_8$
в $v_1$ ). Используя рисунок 1, получаем, что в любом минимальном пути из $v_1$ в $v_8$
соблюдается следующая последовательность вершин. Вершиной, предшествующей
вершине $v_8$ может быть $v_5$. Вершиной, предшествующей вершине $5$
может быть $v_2$. Вершиной, предшествующей вершине $v_2$ – вершина $v_4$. 
Вершиной, предшествующей вершине $v_4$ – любая из вершин $v_3,v_6$. 
Вершинам, предшествующей вершине $v_4$ может предшествовать только $v_1$. Этими условиями однозначно определяется множество
минимальных путей из $v_1$ в $v_8$ которое компактно изображено на рисунке 2. На этом
рисунке изображены все вершины, входящие в минимальные пути $v_1$ в $v_8$ Для каждой
из промежуточных вершин $v$ показано множество вершин, которые могут ей
предшествовать, а также соответствующие дуги (исходящие из вершин, предшествующих $v$
и заходящие в $v$). Из рисунка 2 видно, что всего существует два минимальных пути из $v_1$ в
$v_8$: $v_1v_3v_4v_2v_5v_8$, $v_1v_6v_4v_2v_5v_8$.
\begin{figure}[H]\centering\includesvg[scale=0.5]{graphs/fw2}\caption{График минимальных путей}\end{figure}
\textbf{4.} Нагруженный орграф $D$ задан матрицей длин дуг $C(D)$. Найти минимальные пути из $v_1$ во все достижимые вершины.
\[
C(D)=
\begin{pmatrix}
    \infty & 4      & \infty & \infty & 5      & \infty & \infty & \infty \\
    5      & \infty & 7      & 10     & 2      & \infty & \infty & \infty \\
    \infty & \infty & \infty & 2      & \infty & 2      & \infty & \infty \\
    6      & \infty & \infty & \infty & \infty & \infty & 3      & 5      \\
    3      & 2      & \infty & \infty & \infty & 3      & 11     & \infty \\
    4      & \infty & 2      & \infty & \infty & \infty & 7      & \infty \\
    8      & \infty & \infty & 3      & \infty & \infty & \infty & 3      \\
    \infty & \infty & \infty & \infty & 17     & \infty & \infty & \infty \\
\end{pmatrix}
\]

\underline{\textbf{Решение.}}

Используем алгоритм Форда. Сначала определим таблицу величин $l_{i}^{(i)}, i=1,2,\dots,n-1$, где $n=8$
\begin{center}
\begin{tabular}{ | c | c | c | c | c | c | c | c | c | c |c |c |c |c |c |c |c |c |}
    \hline
    \rule{0pt}{14pt}& $v_1$ & $v_2$ & $v_3$ & $v_4$ & $v_5$ & $v_6$ & $v_7$ & $v_8$&
    &$l^{(0)}$&$l^{(1)}$&$l^{(2)}$&$l^{(3)}$&$l^{(4)}$&$l^{(5)}$&$l^{(6)}$&$l^{(7)}$\\
    \hline
    $v_1$& $\infty$ & 4 & $\infty$ & $\infty$  & 5 & $\infty$  & $\infty$  & $\infty$&
    &\\
    \hline
    $v_2$& 5 & $\infty$  & 7 & 10 & 2 & $\infty$ & $\infty$ & $\infty$&
    &\\
    \hline
    $v_3$& $\infty$  & $\infty$  & $\infty$ & 2 & $\infty$ & 2 & $\infty$ & $\infty$&
    &\\
    \hline
    $v_4$& 6 & $\infty$ & $\infty$ & $\infty$ & $\infty$ & $\infty$ & 3 & 5&
    &\\
    \hline
    $v_5$& 3 & 2 & $\infty$ & $\infty$ & $\infty$ & 3 & 11 & $\infty$&
    &\\
    \hline
    $v_6$& 4 & $\infty$ & 2 & $\infty$ & $\infty$ & $\infty$ & 7 & $\infty$&
    &\\
    \hline
    $v_7$& 8 & $\infty$ & $\infty$ & 3 & $\infty$ & $\infty$ & $\infty$ & 3&
    &\\
    \hline
    $v_8$& $\infty$ & $\infty$ & $\infty$ & $\infty$ & 17 & $\infty$ & $\infty$ & $\infty$&
    &\\
    \hline
\end{tabular}
\end{center}
\hspace{3.5cm}$C(D)$\hspace{6.5cm}Таблица величин


\end{document}
